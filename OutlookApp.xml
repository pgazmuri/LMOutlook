<?xml version="1.0" encoding="utf-8"?>
<OfficeApp xmlns=
  "http://schemas.microsoft.com/office/appforoffice/1.1"
  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
  xsi:type="MailApp">

  <Id>989E76EF-D73E-567F-ADAE-5A76B39065CF</Id>
  <Version>1.0</Version>
  <ProviderName>BlueMetal</ProviderName>
  <DefaultLocale>en-us</DefaultLocale>
  <DisplayName DefaultValue="Claims Email Processor"/>
  <Description DefaultValue="Detects Emails with Claim numbers and allows for forwarding to Navigator.">
    <Override Locale="fr-fr" Value="Visualisez les Claims"/>
  </Description>
  <!-- Change the following line to specify    -->
  <!-- the web serverthat hosts the icon file. -->
  <IconUrl DefaultValue=
    "https://rawgit.com/pgazmuri/LMOutlook/master/Logo.png"/>
  <Hosts>
    <Host Name="Mailbox" />
  </Hosts>
  <Requirements>
    <Sets DefaultMinVersion="1.1">
      <Set Name="Mailbox" />
    </Sets>
  </Requirements>

  <FormSettings>
    <Form xsi:type="ItemRead">
      <DesktopSettings>
        <!-- Change the following line to specify     -->
        <!-- the web server that hosts the HTML file. -->
        <SourceLocation DefaultValue="https://rawgit.com/pgazmuri/LMOutlook/master/read_desktop.html" />
        <RequestedHeight>216</RequestedHeight>
      </DesktopSettings>
      <TabletSettings>
        <!-- Change the following line to specify     -->
        <!-- the web server that hosts the HTML file. -->
        <SourceLocation DefaultValue="https://rawgit.com/pgazmuri/LMOutlook/master/read_desktop.html" />
        <RequestedHeight>216</RequestedHeight>
      </TabletSettings>
    </Form>
    <Form xsi:type="ItemEdit">
      <DesktopSettings>
        <!-- Change the following line to specify     -->
        <!-- the web server that hosts the HTML file. -->
        <SourceLocation DefaultValue="https://rawgit.com/pgazmuri/LMOutlook/master/compose_desktop.html" />
      </DesktopSettings>
      <TabletSettings>
        <!-- Change the following line to specify     -->
        <!-- the web server that hosts the HTML file. -->
        <SourceLocation DefaultValue="https://rawgit.com/pgazmuri/LMOutlook/master/compose_desktop.html" />
      </TabletSettings>
    </Form>
  </FormSettings>

  <Permissions>ReadWriteMailbox</Permissions>

  <Rule xsi:type="RuleCollection" Mode="Or">
    <Rule xsi:type="RuleCollection" Mode="And">
      <Rule xsi:type="ItemIs" ItemType="Message" FormType="Read" />
      <Rule xsi:type="RuleCollection" Mode="Or">
       <Rule xsi:type="ItemHasRegularExpressionMatch" 
        PropertyName="Subject" RegExName="ClaimIDSubject" 
        RegExValue=
        "[a-zA-Z0-9]{9}-[a-zA-Z0-9]{2}" />
       <Rule xsi:type="ItemHasRegularExpressionMatch" 
        PropertyName="BodyAsPlaintext" RegExName="ClaimID" 
        RegExValue=
        "[a-zA-Z0-9]{9}-[a-zA-Z0-9]{2}" />
      </Rule>
    </Rule>
    <Rule xsi:type="RuleCollection" Mode="Or">
      <Rule xsi:type="ItemIs" ItemType="Appointment" FormType="Edit" />
      <Rule xsi:type="ItemIs" ItemType="Message" FormType="Edit" /> 
    </Rule> 
  </Rule>
    
</OfficeApp>